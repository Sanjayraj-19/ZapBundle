<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SaaSBundilo - Save on SaaS Bundles</title>
  <style>
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --primary-light: #a5b4fc;
      --secondary: #ec4899;
      --secondary-dark: #db2777;
      --accent: #06b6d4;
      --accent-dark: #0891b2;
      --dark: #1e293b;
      --light: #f8fafc;
      --gray: #64748b;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --gradient-1: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      --gradient-2: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
      --gradient-3: linear-gradient(135deg, var(--accent) 0%, var(--success) 100%);
      --gradient-4: linear-gradient(135deg, var(--warning) 0%, var(--secondary) 100%);
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }
    
    body {
      background-color: var(--light);
      color: var(--dark);
      padding-top: 80px;
      overflow-x: hidden;
    }
    
    a {
      text-decoration: none;
      color: inherit;
    }
    
    ul {
      list-style: none;
    }
    
    h1, h2, h3, h4, h5, h6 {
      font-weight: 700;
      line-height: 1.2;
    }
    
    h1 {
      font-size: 3.5rem;
      margin-bottom: 1.5rem;
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    h2 {
      font-size: 2.5rem;
      margin-bottom: 2rem;
      position: relative;
      display: inline-block;
    }
    
    h2::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: var(--gradient-1);
      border-radius: 2px;
    }
    
    p {
      line-height: 1.6;
      margin-bottom: 1.5rem;
      color: var(--gray);
    }
    
    /* Background Elements */
    .bg-shape {
      position: absolute;
      z-index: -1;
      opacity: 0.5;
    }
    
    .bg-shape-1 {
      top: 10%;
      left: -10%;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, var(--primary-light) 0%, rgba(99, 102, 241, 0) 70%);
      border-radius: 50%;
      filter: blur(50px);
    }
    
    .bg-shape-2 {
      bottom: 20%;
      right: -10%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, var(--accent) 0%, rgba(6, 182, 212, 0) 70%);
      border-radius: 50%;
      filter: blur(60px);
    }
    
    .bg-shape-3 {
      top: 60%;
      left: 5%;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, var(--secondary) 0%, rgba(236, 72, 153, 0) 70%);
      border-radius: 50%;
      filter: blur(40px);
    }
    
    /* Navbar */
    .navbar {
      background-color: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      position: fixed;
      top: 0;
      width: 100%;
      height: 80px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 5%;
      box-shadow: var(--shadow-md);
      z-index: 1000;
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .navbar.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .logo-bar {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    
    .logo-img {
      height: 60px;
      width: auto;
      background: transparent !important;
      box-shadow: none;
      border: none;
      object-fit: contain;
      transition: transform 0.3s ease;
      mix-blend-mode: multiply;
      filter: contrast(1.1) brightness(1.1);
    }
    
    .logo-img:hover {
      transform: scale(1.05);
    }
    
    .logo-text {
      font-size: 2.2rem;
      font-weight: 700;
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .top-button {
      background: var(--gradient-1);
      color: white;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-md);
      border: none;
      cursor: pointer;
    }
    
    .top-button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }


    
    /* Hero Section */
    .hero-section {
      position: relative;
      padding: 100px 5% 120px;
      text-align: center;
      overflow: hidden;
    }
    
    .hero-content {
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }
    
    .hero-description {
      font-size: 1.25rem;
      margin-bottom: 2.5rem;
      color: var(--gray);
    }
    
    .cta-button {
      background: var(--gradient-1);
      color: white;
      padding: 16px 36px;
      border-radius: 50px;
      font-size: 1.2rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-lg);
      display: inline-block;
      border: none;
      cursor: pointer;
    }
    
    .cta-button:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow-xl);
    }
    
    .hero-image {
      max-width: 100%;
      margin-top: 3rem;
      border-radius: 20px;
      box-shadow: var(--shadow-xl);
    }
    
    /* Features Section */
    .features-section {
      padding: 100px 5%;
      text-align: center;
      position: relative;
    }
    
    .features-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-top: 50px;
    }
    
    .feature-card {
      background: white;
      border-radius: 20px;
      padding: 40px 30px;
      width: 300px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: var(--gradient-1);
      z-index: -1;
    }
    
    .feature-card:hover {
      transform: translateY(-10px);
      box-shadow: var(--shadow-xl);
    }
    
    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 20px;
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .feature-title {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: var(--dark);
    }
    
    .feature-description {
      color: var(--gray);
      font-size: 1rem;
    }
    
    /* How It Works Section */
    .how-it-works-section {
      padding: 100px 5%;
      text-align: center;
      position: relative;
      background-color: #f8fafc;
    }
    
    .steps-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-top: 50px;
    }
    
    .step-card {
      background: white;
      border-radius: 20px;
      padding: 40px 30px;
      width: 300px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .step-card:hover {
      transform: translateY(-10px);
      box-shadow: var(--shadow-xl);
    }
    
    .step-number {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      background: var(--gradient-1);
      color: white;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      font-weight: 700;
    }
    
    .step-icon {
      font-size: 2.5rem;
      margin-bottom: 20px;
      color: var(--primary);
    }
    
    .step-title {
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: var(--dark);
    }
    
    .step-description {
      color: var(--gray);
      font-size: 1rem;
    }
    
    /* Bundles Section */
    .bundles-section {
      padding: 100px 5%;
      text-align: center;
      background-color: #f1f5f9;
      position: relative;
    }
    
    .bundles-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-top: 50px;
    }
    
    .bundle-card {
      width: 280px;
      height: 350px;
      perspective: 1000px;
      cursor: pointer;
    }
    
    .bundle-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.8s;
      transform-style: preserve-3d;
    }
    
    .bundle-card:hover .bundle-inner {
      transform: rotateY(180deg);
    }
    
    .bundle-front, .bundle-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 30px;
      box-shadow: var(--shadow-lg);
    }
    
    .bundle-front {
      color: white;
      font-size: 1.5rem;
      font-weight: 700;
    }
    
    .bundle-back {
      background: white;
      color: var(--dark);
      transform: rotateY(180deg);
      font-size: 1rem;
      line-height: 1.6;
    }
    
    .bundle-icon {
      font-size: 3rem;
      margin-bottom: 20px;
    }
    
    /* Survey Section */
    .survey-section {
      padding: 80px 5%;
      text-align: center;
      position: relative;
    }
    
    .survey-button {
      background: var(--gradient-2);
      color: white;
      padding: 15px 30px;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-md);
      display: inline-block;
    }
    
    .survey-button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }
    
    /* Testimonials Section */
    .testimonials-section {
      padding: 100px 5%;
      text-align: center;
      background-color: #f1f5f9;
      position: relative;
    }
    
    .testimonials-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-top: 50px;
    }
    
    .testimonial-card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      width: 350px;
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
      text-align: left;
    }
    
    .testimonial-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .testimonial-text {
      font-size: 1rem;
      line-height: 1.6;
      margin-bottom: 20px;
      color: var(--dark);
      font-style: italic;
    }
    
    .testimonial-author {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .author-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
    }
    
    .author-info {
      text-align: left;
    }
    
    .author-name {
      font-weight: 600;
      color: var(--dark);
    }
    
    .author-title {
      font-size: 0.9rem;
      color: var(--gray);
    }
    
    /* Join Us Section */
    .join-section {
      padding: 100px 5%;
      text-align: center;
      position: relative;
      background: var(--gradient-1);
      color: white;
    }
    
    .join-section h2 {
      color: white;
    }
    
    .join-section h2::after {
      background: white;
    }
    
    .join-section p {
      color: rgba(255, 255, 255, 0.8);
      max-width: 700px;
      margin: 0 auto 30px;
    }
    
    .join-button {
      background: white;
      color: var(--primary);
      padding: 15px 30px;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-md);
      display: inline-block;
      border: none;
      cursor: pointer;
    }
    
    .join-button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }
    
    /* Contact Section */
    .contact-section {
      padding: 100px 5%;
      position: relative;
    }
    
    .contact-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: var(--shadow-lg);
    }
    
    .contact-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .form-label {
      font-weight: 500;
      color: var(--dark);
    }
    
    .form-input {
      padding: 12px 15px;
      border: 1px solid #e2e8f0;
      border-radius: 10px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
    }
    
    .form-textarea {
      height: 150px;
      resize: vertical;
    }
    
    .submit-button {
      background: var(--gradient-1);
      color: white;
      padding: 15px;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-md);
      border: none;
      cursor: pointer;
      margin-top: 10px;
    }
    
    .submit-button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }
    
    /* Footer */
    .footer {
      background-color: var(--dark);
      color: white;
      text-align: center;
      padding: 30px 20px;
      font-size: 0.9rem;
      margin-top: auto;
      animation: fadeIn 0.7s cubic-bezier(.4,0,.2,1);
    }
    
    .footer .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    /* Animations */
    .fade-in {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .fade-in-left {
      opacity: 0;
      transform: translateX(-50px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    
    .fade-in-left.visible {
      opacity: 1;
      transform: translateX(0);
    }
    
    .fade-in-right {
      opacity: 0;
      transform: translateX(50px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    
    .fade-in-right.visible {
      opacity: 1;
      transform: translateX(0);
    }
    
    /* Popup Overlay */
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      backdrop-filter: blur(8px);
      background: rgba(15, 23, 42, 0.6);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    .popup {
      background: white;
      width: 95%;
      max-width: 500px;
      border-radius: 20px;
      padding: 40px;
      box-shadow: var(--shadow-xl);
      position: relative;
      animation: popupIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    @keyframes popupIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes popupOut {
      from { opacity: 1; transform: scale(1); }
      to { opacity: 0; transform: scale(0.9); }
    }
    
    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--gray);
      transition: color 0.3s ease;
      background: none;
      border: none;
      width: 30px;
      height: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 50%;
    }
    
    .close-btn:hover {
      color: var(--danger);
      background: rgba(239, 68, 68, 0.1);
    }
    
    .popup h2 {
      margin-bottom: 20px;
      font-size: 1.8rem;
    }
    
    .popup h2::after {
      display: none;
    }
    
    .bundle-search {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #e2e8f0;
      border-radius: 10px;
      font-size: 1rem;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }
    
    .bundle-search:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
    }
    
    .saas-list {
      max-height: 250px;
      overflow-y: auto;
      margin-bottom: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-right: 10px;
    }
    
    .saas-list::-webkit-scrollbar {
      width: 6px;
    }
    
    .saas-list::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 10px;
    }
    
    .saas-list::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 10px;
    }
    
    .saas-list::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
    
    .saas-list label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1rem;
      background: #f8fafc;
      border-radius: 10px;
      padding: 10px 15px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .saas-list label:hover {
      background: #f1f5f9;
      transform: translateX(5px);
    }
    
    .saas-list input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--primary);
    }
    
    .other-bundle-section {
      margin-top: 20px;
    }
    
    .confirm-btn {
      width: 100%;
      padding: 15px;
      background: var(--gradient-1);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-md);
      margin-top: 20px;
    }
    
    .confirm-btn:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }
    
    /* User Dropdown */
    .dropdown {
      position: relative;
    }
    
    .dropdown-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      object-fit: cover;
      cursor: pointer;
      border: 2px solid var(--primary);
      transition: all 0.3s ease;
    }
    
    .dropdown-avatar:hover {
      transform: scale(1.1);
      box-shadow: var(--shadow-md);
    }
    
    .dropdown-menu {
      position: absolute;
      top: 60px;
      right: 0;
      background: white;
      border-radius: 15px;
      min-width: 200px;
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      display: none;
      flex-direction: column;
      z-index: 100;
      animation: dropdownIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    @keyframes dropdownIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes dropdownOut {
      from { opacity: 1; transform: translateY(0); }
      to { opacity: 0; transform: translateY(-10px); }
    }
    
    .dropdown-menu.show {
      display: flex;
    }
    
    .dropdown-menu a {
      padding: 15px 20px;
      color: var(--dark);
      font-weight: 500;
      transition: all 0.3s ease;
      border-bottom: 1px solid #f1f5f9;
    }
    
    .dropdown-menu a:last-child {
      border-bottom: none;
    }
    
    .dropdown-menu a:hover {
      background: #f8fafc;
      color: var(--primary);
      padding-left: 25px;
    }
    
    /* Responsive Design */
    @media (max-width: 1024px) {
      h1 {
        font-size: 3rem;
      }
      
      h2 {
        font-size: 2.2rem;
      }
      
      .feature-card, .testimonial-card {
        width: 280px;
      }
    }
    
    @media (max-width: 768px) {
      h1 {
        font-size: 2.5rem;
      }
      
      h2 {
        font-size: 2rem;
      }
      
      .navbar {
        padding: 0 20px;
      }
      
      .hero-section, .features-section, .bundles-section, 
      .survey-section, .testimonials-section, .join-section, 
      .contact-section {
        padding: 80px 20px;
      }
      
      /* Footer is already responsive */
    }
    
    @media (max-width: 480px) {
      h1 {
        font-size: 2rem;
      }
      
      h2 {
        font-size: 1.8rem;
      }
      
      .navbar {
        height: auto;
        padding: 15px 20px;
      }
      
      .logo-text {
        font-size: 1.5rem;
      }
      
      .top-button, .cta-button, .survey-button, .join-button {
        padding: 10px 20px;
        font-size: 0.9rem;
      }
      
      .popup {
        padding: 30px 20px;
      }
    }

    /* Notification Popup Styles */
    .notification-popup {
      position: fixed;
      top: 100px;
      right: 20px;
      width: 350px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      z-index: 9999;
      transform: translateX(400px);
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border-left: 5px solid var(--primary);
    }

    .notification-popup.show {
      transform: translateX(0);
      opacity: 1;
    }

    .notification-content {
      padding: 20px;
      position: relative;
    }

    .notification-close {
      position: absolute;
      top: 10px;
      right: 15px;
      background: none;
      border: none;
      font-size: 20px;
      color: var(--gray);
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .notification-close:hover {
      color: var(--danger);
    }

    .notification-icon {
      display: inline-block;
      width: 40px;
      height: 40px;
      background: var(--gradient-1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
      animation: notificationPulse 2s infinite;
    }

    .notification-icon i {
      color: white;
      font-size: 18px;
    }

    @keyframes notificationPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    @keyframes pulse {
      0% { transform: scale(1.05); }
      50% { transform: scale(1.08); }
      100% { transform: scale(1.05); }
    }

    .notification-text h4 {
      font-size: 1.1rem;
      margin-bottom: 8px;
      color: var(--dark);
      font-weight: 600;
    }

    .notification-text p {
      font-size: 0.9rem;
      color: var(--gray);
      margin-bottom: 15px;
      line-height: 1.4;
    }

    .notification-btn {
      background: var(--gradient-1);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }

    .notification-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
    }

    .notification-btn.secondary {
      background: var(--gradient-2);
    }

    .notification-btn.success {
      background: var(--gradient-3);
    }

    .notification-btn.popular {
      background: var(--gradient-4);
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .notification-popup {
        width: 300px;
        right: 10px;
        top: 90px;
      }

      .notification-content {
        padding: 15px;
      }

      .notification-text h4 {
        font-size: 1rem;
      }

      .notification-text p {
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <!-- Background Shapes -->
  <div class="bg-shape bg-shape-1"></div>
  <div class="bg-shape bg-shape-2"></div>
  <div class="bg-shape bg-shape-3"></div>
  
  <!-- Navbar -->
  <nav class="navbar" id="mainNavbar">
    <div class="logo-bar">
      <img src="icons/SaaSBundilo.jpg" alt="SaaSBundilo Logo" class="logo-img">
    </div>
    <div id="nav-button-area"></div>
  </nav>
  
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content fade-in">
      <h1>Save Money on SaaS with Perfect Bundles for Your Business</h1>
      <p class="hero-description">We bundle premium SaaS tools into cost-effective packages, giving you exclusive access to the tools you need at prices you'll love.</p>
      <a href="signup.html" class="cta-button hide-on-login">Get Early Access</a>
      <img src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80" alt="SaaS Dashboard" class="hero-image">
    </div>
  </section>
  
  <!-- Features Section -->
  <section class="features-section">
    <h2 class="fade-in">Why Choose Our Bundles?</h2>
    <div class="features-container">
      <div class="feature-card fade-in-left">
        <i class="fas fa-piggy-bank feature-icon"></i>
        <h3 class="feature-title">Save up to 40%</h3>
        <p class="feature-description">Significant discounts on premium SaaS tools compared to purchasing them individually.</p>
      </div>
      
      <div class="feature-card fade-in">
        <i class="fas fa-tasks feature-icon"></i>
        <h3 class="feature-title">Simplified Management</h3>
        <p class="feature-description">Manage all your subscriptions with ease in one centralized bundle dashboard.</p>
      </div>
      
      <div class="feature-card fade-in-right">
        <i class="fas fa-star feature-icon"></i>
        <h3 class="feature-title">Expertly Curated</h3>
        <p class="feature-description">Bundles selected by industry experts for maximum compatibility and efficiency.</p>
      </div>
    </div>
  </section>
  
  <!-- How It Works Section -->
  <section class="how-it-works-section">
    <h2 class="fade-in">Get Started in 3 Simple Steps</h2>
    <div class="steps-container">
      <div class="step-card fade-in-left">
        <div class="step-number">1</div>
        <div class="step-icon"><i class="fas fa-user-plus"></i></div>
        <h3 class="step-title">Sign Up</h3>
        <p class="step-description">Create your free SaaSBundilo account to get started. No credit card required for early access.</p>
      </div>
      
      <div class="step-card fade-in">
        <div class="step-number">2</div>
        <div class="step-icon"><i class="fas fa-clipboard-list"></i></div>
        <h3 class="step-title">Complete Short Survey</h3>
        <p class="step-description">Tell us about your business needs and which SaaS tools you're interested in bundling together.</p>
      </div>
      
      <div class="step-card fade-in-right">
        <div class="step-number">3</div>
        <div class="step-icon"><i class="fas fa-box-open"></i></div>
        <h3 class="step-title">Choose Your Bundle</h3>
        <p class="step-description">Select from our recommended bundles based on your survey or create your own custom package.</p>
      </div>
    </div>
  </section>
  
  <!-- Bundles Section -->
  <section class="bundles-section">
    <h2 class="fade-in">Popular Bundles</h2>
    <div class="bundles-container">
      <div class="bundle-card fade-in-left" onclick="handleBundleClick('Marketing Master Bundle')">
        <div class="bundle-inner">
          <div class="bundle-front" style="background: var(--gradient-2);">
            <i class="fas fa-bullhorn bundle-icon"></i>
            <span>Marketing Master Bundle</span>
          </div>
          <div class="bundle-back">
            <h3>Marketing Master</h3>
            <p>Includes tools for email campaigns, analytics & ad management ‚Äî ideal for growth hackers & marketers.</p>
          </div>
        </div>
      </div>
      
      <div class="bundle-card fade-in" onclick="handleBundleClick('Productivity Power Bundle')">
        <div class="bundle-inner">
          <div class="bundle-front" style="background: var(--gradient-1);">
            <i class="fas fa-bolt bundle-icon"></i>
            <span>Productivity Power Bundle</span>
          </div>
          <div class="bundle-back">
            <h3>Productivity Power</h3>
            <p>Task tracking, team collaboration, note-taking & automation tools to supercharge your productivity.</p>
          </div>
        </div>
      </div>
      
      <div class="bundle-card fade-in" onclick="handleBundleClick('Design & Dev Bundle')">
        <div class="bundle-inner">
          <div class="bundle-front" style="background: var(--gradient-3);">
            <i class="fas fa-code bundle-icon"></i>
            <span>Design & Dev Bundle</span>
          </div>
          <div class="bundle-back">
            <h3>Design & Development</h3>
            <p>UI kits, prototyping, IDE tools, version control and more for developers & designers.</p>
          </div>
        </div>
      </div>
      
      <div class="bundle-card fade-in-right" onclick="handleBundleClick('custom')">
        <div class="bundle-inner">
          <div class="bundle-front" style="background: var(--gradient-4);">
            <i class="fas fa-magic bundle-icon"></i>
            <span>Create Your Own Bundle</span>
          </div>
          <div class="bundle-back">
            <h3>Custom Bundle</h3>
            <p>Tell us what tools you want. We're collecting feedback to focus on the most requested bundles.</p>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Survey Section -->
  <section class="survey-section">
    <h2 class="fade-in">Help Us Build the Right Bundles</h2>
    <p class="fade-in" style="color: var(--gray); font-size: 1.1rem; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
      Can't find the perfect bundle? Create your own custom bundle with the SaaS tools you need most!
    </p>
    <button class="survey-button fade-in" onclick="scrollToCreateBundle()"><i class="fas fa-plus-circle"></i> Create Your Own Bundle</button>
    <button class="survey-button fade-in" id="surveyBtn" onclick="startSurvey()" style="background: var(--gradient-2); margin-left: 10px;"><i class="fas fa-clipboard-list"></i> Take Survey</button>
    <button class="survey-button fade-in" onclick="forceRefreshSurveyStatus()" style="background: #28a745; margin-left: 10px; font-size: 0.8rem; padding: 8px 16px;"><i class="fas fa-sync"></i> Refresh Status</button>
    <button class="survey-button fade-in" id="resetSurveyBtn" onclick="resetSurveyData()" style="background: #dc3545; margin-left: 10px; font-size: 0.8rem; padding: 8px 16px;"><i class="fas fa-redo"></i> Reset Survey (Debug)</button>
  </section>
  
  <!-- Testimonials Section -->
  <section class="testimonials-section">
    <h2 class="fade-in">What Businesses Are Saying</h2>
    <div class="testimonials-container">
      <div class="testimonial-card fade-in-left">
        <p class="testimonial-text">"As a small startup, managing multiple SaaS subscriptions was becoming expensive and complicated. SaaSBundilo's idea would greatly help us streamline our tools and save money."</p>
        <div class="testimonial-author">
          <div class="author-info">
            <div class="author-title">Tech Startup</div>
          </div>
        </div>
      </div>
      
      <div class="testimonial-card fade-in">
        <p class="testimonial-text">"The marketing bundle gave us access to premium tools we couldn't afford individually. The idea of SaaSBundilo would help us scale our marketing efforts without breaking the bank."</p>
        <div class="testimonial-author">
          <div class="author-info">
            <div class="author-title">Growth Marketing Company</div>
          </div>
        </div>
      </div>
      
      <div class="testimonial-card fade-in-right">
        <p class="testimonial-text">"Finally a solution that understands the pain points of small businesses. The single invoice for all our tools will simplify our accounting significantly and save us valuable time."</p>
        <div class="testimonial-author">
          <div class="author-info">
            <div class="author-title">Small Business</div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Join Us Section -->
  <section class="join-section">
    <h2 class="fade-in">Join 100+ Businesses Exploring SaaS Bundles!</h2>
    <p class="fade-in">Be the first to know when we launch and get exclusive early access discounts on our premium SaaS bundles.</p>
    <button onclick="window.location.href='signup.html'" class="join-button fade-in hide-on-login">Get Early Access</button>
  </section>
  
  <!-- Contact Section -->
  <section class="contact-section" id="contact-us">
    <div class="contact-container fade-in">
      <h2>Contact Us</h2>
      <form action="https://formsubmit.co/zapbundle@gmail.com" method="POST" class="contact-form">
        <div class="form-group">
          <label for="name" class="form-label">Your Name</label>
          <input type="text" id="name" name="name" class="form-input" required>
        </div>
        
        <div class="form-group">
          <label for="email" class="form-label">Your Email</label>
          <input type="email" id="email" name="email" class="form-input" required>
        </div>
        
        <div class="form-group">
          <label for="message" class="form-label">Your Message</label>
          <textarea id="message" name="message" class="form-input form-textarea" required></textarea>
        </div>
        
        <button type="submit" class="submit-button">Send Message</button>
      </form>
    </div>
  </section>
  
  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 SaaSBundilo. All rights reserved.</p>
      <p>Helping businesses save on SaaS since day one.</p>
    </div>
  </footer>
  
  <!-- Bundle Selection Popup -->
  <div class="overlay" id="bundleOverlay" onclick="closeOnOutside(event)">
    <div class="popup" onclick="event.stopPropagation()">
      <button class="close-btn" onclick="closeMenu()"><i class="fas fa-times"></i></button>
      <h2>Select SaaS Tools for Your Custom Bundle</h2>
      <input type="text" placeholder="Search SaaS tools..." onkeyup="filterSaaS(this.value)" class="bundle-search">
      
      <div class="saas-list" id="saasList">
        <label><input type="checkbox" value="Slack"> Slack</label>
        <label><input type="checkbox" value="Trello"> Trello</label>
        <label><input type="checkbox" value="Notion"> Notion</label>
        <label><input type="checkbox" value="Asana"> Asana</label>
        <label><input type="checkbox" value="GitHub"> GitHub</label>
        <label><input type="checkbox" value="Zoom"> Zoom</label>
        <label><input type="checkbox" value="Dropbox"> Dropbox</label>
        <label><input type="checkbox" value="Google Workspace"> Google Workspace</label>
        <label><input type="checkbox" value="Microsoft 365"> Microsoft 365</label>
        <label><input type="checkbox" value="Salesforce"> Salesforce</label>
        <label><input type="checkbox" value="HubSpot"> HubSpot</label>
        <label><input type="checkbox" value="Mailchimp"> Mailchimp</label>
        <label><input type="checkbox" value="Zendesk"> Zendesk</label>
        <label><input type="checkbox" value="Airtable"> Airtable</label>
        <label><input type="checkbox" value="Monday.com"> Monday.com</label>
        <label><input type="checkbox" value="Figma"> Figma</label>
        <label><input type="checkbox" value="Canva"> Canva</label>
        <label><input type="checkbox" value="ClickUp"> ClickUp</label>
        <label><input type="checkbox" value="Intercom"> Intercom</label>
        <label><input type="checkbox" value="Freshdesk"> Freshdesk</label>
      </div>
      
      <div class="other-bundle-section">
        <label>
          <input type="checkbox" id="otherBundleCheck" onchange="toggleOtherInput(this)">
          <span>Other (not listed)</span>
        </label>
        <input type="text" id="otherBundleInput" class="bundle-search" placeholder="Enter your desired SaaS tool(s)" style="display:none; margin-top:10px;">
      </div>
      
      <button class="confirm-btn" onclick="submitCustomBundle()">Confirm Selection</button>
    </div>
  </div>
  
  <script>
    // Navbar animation on page load
    window.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        document.getElementById('mainNavbar').classList.add('visible');
      }, 100);
    });
    
    // Scroll animations
    function revealOnScroll() {
      const elements = document.querySelectorAll('.fade-in, .fade-in-left, .fade-in-right');
      const windowHeight = window.innerHeight;
      
      elements.forEach(el => {
        const elementTop = el.getBoundingClientRect().top;
        if (elementTop < windowHeight - 100) {
          el.classList.add('visible');
        }
      });
    }
    
    window.addEventListener('scroll', revealOnScroll);
    window.addEventListener('load', revealOnScroll);
    
    // Custom Bundle Popup Logic
    function openMenu(enable) {
      const overlay = document.getElementById('bundleOverlay');
      const popup = overlay.querySelector('.popup');
      
      if (enable) {
        overlay.style.display = 'flex';
        popup.style.animation = 'popupIn 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
      } else {
        closeMenu();
      }
    }
    
    function closeMenu() {
      const overlay = document.getElementById('bundleOverlay');
      const popup = overlay.querySelector('.popup');
      
      popup.style.animation = 'popupOut 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
      setTimeout(() => {
        overlay.style.display = 'none';
      }, 300);
    }
    
    function closeOnOutside(e) {
      if (e.target.id === 'bundleOverlay') closeMenu();
    }
    
    function filterSaaS(query) {
      const items = document.querySelectorAll('#saasList label');
      items.forEach(label => {
        const name = label.textContent.toLowerCase();
        label.style.display = name.includes(query.toLowerCase()) ? 'flex' : 'none';
      });
    }
    
    function toggleOtherInput(checkbox) {
      document.getElementById('otherBundleInput').style.display = checkbox.checked ? 'block' : 'none';
    }
    
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeMenu();
    });
    
    // Backend-aware login/profile logic
    const API_URL = "https://zapbundle.onrender.com";
    
    function getToken() {
      return localStorage.getItem('token');
    }
    
    function authHeader() {
      return { "Authorization": "Bearer " + getToken() };
    }
    
    async function getProfile() {
      const token = getToken();
      if (!token) return null;
      
      try {
        const res = await fetch(`${API_URL}/api/profile`, { headers: authHeader() });
        if (!res.ok) return null;
        return await res.json();
      } catch {
        return null;
      }
    }
    
    async function renderNavButtonArea() {
      const navArea = document.getElementById('nav-button-area');
      if (!navArea) return;
      navArea.innerHTML = "";
      
      const profile = await getProfile();
      
      // Hide or show all .hide-on-login elements
      document.querySelectorAll('.hide-on-login').forEach(el => {
        el.style.display = profile ? 'none' : '';
      });
      
      if (!profile) {
        navArea.innerHTML = `<a href="signup.html" class="top-button" id="main-cta-btn">Get Early Access</a>`;
        return;
      }
      
      // Show avatar/profile dropdown
      const profilePic = profile.profilePic || 'icons/default-profile.png';
      navArea.innerHTML = `
        <div class="dropdown" id="dropdown">
          <img id="navProfilePic" class="dropdown-avatar" src="${profilePic}" alt="Profile" />
          <div class="dropdown-menu" id="dropdownMenu">
            <a href="index.html"><i class="fas fa-home"></i> Home</a>
            <a href="profile.html"><i class="fas fa-user"></i> Profile</a>
            <a href="index.html#contact-us"><i class="fas fa-envelope"></i> Contact Us</a>
            <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
          </div>
        </div>
      `;
      
      // Dropdown logic
      const dropdown = document.getElementById('dropdown');
      const dropdownMenu = document.getElementById('dropdownMenu');
      const navProfilePic = document.getElementById('navProfilePic');
      
      navProfilePic.addEventListener('click', function(e) {
        e.stopPropagation();
        dropdownMenu.classList.toggle('show');
      });
      
      document.addEventListener('click', function(e) {
        if (!dropdown.contains(e.target)) {
          dropdownMenu.classList.remove('show');
        }
      });
    }
    
    function logout() {
      localStorage.removeItem('token');
      location.href = "index.html";
    }
    
    // Check if user has completed the survey and update the survey button
    async function updateSurveyButton() {
      const surveyBtn = document.getElementById('surveyBtn');
      if (!surveyBtn) return;
      
      const token = localStorage.getItem('token');
      if (!token) {
        // User not logged in, show default survey button
        surveyBtn.innerHTML = '<i class="fas fa-clipboard-list"></i> Take the Survey';
        surveyBtn.onclick = function() {
          alert('Please log in to take the survey.');
          window.location.href = 'signup.html';
        };
        return;
      }
      
      try {
        // Fetch user profile from database to check survey completion
        const response = await fetch('https://zapbundle.onrender.com/api/profile', {
          headers: {
            'Authorization': 'Bearer ' + token
          }
        });
        
        if (response.ok) {
          const profile = await response.json();
          console.log('üîç Profile survey status:', profile.surveyCompleted);
          
          if (profile.surveyCompleted) {
            // User has completed the survey in database
            console.log('‚úÖ Survey completed - updating button');
            surveyBtn.innerHTML = '<i class="fas fa-check-circle"></i> Survey Completed';
            surveyBtn.style.background = 'linear-gradient(135deg, var(--success) 0%, var(--accent) 100%)';
            surveyBtn.onclick = function() {
              alert('Thank you for completing our survey! üéâ');
            };
          } else {
            console.log('‚ùå Survey not completed - checking partial data');
            // Check if user has partial survey data
            try {
              const surveyResponse = await fetch('https://zapbundle.onrender.com/api/survey', {
                headers: {
                  'Authorization': 'Bearer ' + token
                }
              });
              
              if (surveyResponse.ok) {
                const surveyData = await surveyResponse.json();
                const hasPartialData = Object.keys(surveyData.answers || {}).length > 0;
                
                if (hasPartialData) {
                  surveyBtn.innerHTML = '<i class="fas fa-edit"></i> Continue Survey';
                  surveyBtn.style.background = 'linear-gradient(135deg, var(--warning) 0%, var(--secondary) 100%)';
                } else {
                  surveyBtn.innerHTML = '<i class="fas fa-clipboard-list"></i> Take the Survey';
                  surveyBtn.style.background = ''; // Reset background
                }
              } else {
                surveyBtn.innerHTML = '<i class="fas fa-clipboard-list"></i> Take the Survey';
                surveyBtn.style.background = ''; // Reset background
              }
            } catch (surveyError) {
              surveyBtn.innerHTML = '<i class="fas fa-clipboard-list"></i> Take the Survey';
              surveyBtn.style.background = ''; // Reset background
            }
            
            surveyBtn.onclick = startSurvey;
          }
        } else {
          // API call failed, fallback to default
          surveyBtn.innerHTML = '<i class="fas fa-clipboard-list"></i> Take the Survey';
          surveyBtn.onclick = startSurvey;
        }
      } catch (error) {
        console.error('Error checking survey status:', error);
        // Fallback for when server is unavailable
        if (token) {
          surveyBtn.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Server Offline';
          surveyBtn.style.background = '#dc3545';
          surveyBtn.onclick = function() {
            alert('Server is temporarily unavailable. Please try again later.');
          };
        } else {
          surveyBtn.innerHTML = '<i class="fas fa-clipboard-list"></i> Take the Survey';
          surveyBtn.onclick = function() {
            alert('Please log in to take the survey.');
            window.location.href = 'signup.html';
          };
        }
      }
    }
    
    // Clear old localStorage survey data to ensure database is source of truth
    function clearOldSurveyData() {
      localStorage.removeItem('surveyCompleted');
      localStorage.removeItem('surveys');
    }

    // Debug function to reset survey data
    async function resetSurveyData() {
      const token = localStorage.getItem('token');
      if (!token) {
        alert('Please log in first');
        return;
      }

      if (confirm('Are you sure you want to reset your survey data? This will delete all your answers.')) {
        try {
          const response = await fetch('https://zapbundle.onrender.com/api/survey/reset', {
            method: 'DELETE',
            headers: {
              'Authorization': 'Bearer ' + token
            }
          });

          if (response.ok) {
            alert('Survey data reset successfully!');
            updateSurveyButton();
          } else {
            alert('Failed to reset survey data');
          }
        } catch (error) {
          console.error('Reset error:', error);
          alert('Error resetting survey data');
        }
      }
    }

    // Notification System
    let notificationAction = 'survey'; // 'survey', 'bundles', 'create'
    let notificationShown = false;

    async function checkAndShowNotification() {
      console.log('üîî Checking notification status...');
      const token = localStorage.getItem('token');
      if (!token) {
        console.log('‚ùå No token found, user not logged in');
        return; // Don't show notifications for non-logged-in users
      }

      // Don't show if already shown in this session
      if (notificationShown) {
        console.log('‚ùå Notification already shown in this session');
        return;
      }

      try {
        console.log('üì° Fetching user profile...');
        // Check user's current status
        const profileResponse = await fetch('https://zapbundle.onrender.com/api/profile', {
          headers: {
            'Authorization': 'Bearer ' + token
          }
        });

        if (!profileResponse.ok) {
          console.log('‚ùå Profile fetch failed:', profileResponse.status);
          return;
        }

        const profile = await profileResponse.json();
        console.log('üë§ Profile data:', profile);
        console.log('üë§ Profile surveyCompleted field:', profile.surveyCompleted, typeof profile.surveyCompleted);
        
        // Check survey status
        console.log('üìã Fetching survey data...');
        const surveyResponse = await fetch('https://zapbundle.onrender.com/api/survey', {
          headers: {
            'Authorization': 'Bearer ' + token
          }
        });

        let surveyData = { isComplete: false, answers: {} };
        if (surveyResponse.ok) {
          surveyData = await surveyResponse.json();
          console.log('üìã Survey data from server:', surveyData);
          console.log('üìã Survey isComplete from server:', surveyData.isComplete);
        } else {
          console.log('‚ùå Survey fetch failed:', surveyResponse.status);
        }

        // Check bundles status (optional - endpoint might not exist yet)
        console.log('üì¶ Fetching bundles data...');
        let userBundles = [];
        try {
          const bundlesResponse = await fetch('https://zapbundle.onrender.com/api/bundles', {
            headers: {
              'Authorization': 'Bearer ' + token
            }
          });

          if (bundlesResponse.ok) {
            userBundles = await bundlesResponse.json();
            console.log('üì¶ User bundles:', userBundles);
          } else {
            console.log('‚ùå Bundles fetch failed:', bundlesResponse.status, '- assuming no bundles');
          }
        } catch (bundleError) {
          console.log('‚ùå Bundles API not available - assuming no bundles');
        }

        // Determine what notification to show
        console.log('üîç Analyzing notification conditions...');
        console.log('Survey completed (profile):', profile.surveyCompleted);
        console.log('Survey complete (data):', surveyData.isComplete);
        console.log('User bundles count:', userBundles.length);
        
        let shouldShowNotification = false;
        
        // Use profile.surveyCompleted as the primary source of truth
        const isSurveyCompleted = profile.surveyCompleted || false;
        console.log('üéØ Final survey completion status:', isSurveyCompleted);
        
        if (!isSurveyCompleted) {
          // User hasn't completed survey - PRIORITY 1
          console.log('‚úÖ Showing survey notification');
          showNotification(
            'Complete Your Journey!',
            'Take our survey to get personalized bundle recommendations',
            'Take Survey',
            'survey',
            'fas fa-clipboard-list'
          );
          shouldShowNotification = true;
        } else if (isSurveyCompleted && userBundles.length === 0) {
          // User completed survey but has no bundles - PRIORITY 2
          console.log('‚úÖ Showing bundles notification');
          showNotification(
            'Ready for Bundles!',
            'Great! Now choose from our curated bundles or create your own',
            'View Bundles',
            'bundles',
            'fas fa-box-open'
          );
          shouldShowNotification = true;
        } else if (isSurveyCompleted && userBundles.length > 0) {
          // User has completed survey and has bundles - show popular bundle notification
          console.log('‚úÖ Showing popular bundle notification');
          showNotification(
            'Discover Popular Bundles!',
            'Check out trending bundles or create your own custom bundle',
            'Explore Popular',
            'popular',
            'fas fa-fire'
          );
          shouldShowNotification = true;
        } else {
          console.log('‚ùå No notification needed');
        }
      } catch (error) {
        console.error('Error checking notification status:', error);
        // Server is down - show offline notification
        if (!localStorage.getItem('token')) {
          showNotification(
            'Welcome to SaaSBundilo!',
            'Discover amazing SaaS bundles and save up to 70% on your favorite tools',
            'Get Started',
            'signup',
            'fas fa-rocket'
          );
        } else {
          showNotification(
            'Server Temporarily Unavailable',
            'We are working to restore service. Please try again in a few minutes.',
            'Refresh Page',
            'refresh',
            'fas fa-exclamation-triangle'
          );
        }
      }
    }

    function showNotification(title, message, buttonText, action, icon = 'fas fa-bell') {
      console.log('üéâ Showing notification:', title);
      const popup = document.getElementById('notificationPopup');
      const titleEl = document.getElementById('notificationTitle');
      const messageEl = document.getElementById('notificationMessage');
      const actionBtn = document.getElementById('notificationAction');
      const iconEl = popup.querySelector('.notification-icon i');

      if (!popup) {
        console.error('‚ùå Notification popup element not found!');
        return;
      }

      titleEl.textContent = title;
      messageEl.textContent = message;
      actionBtn.textContent = buttonText;
      iconEl.className = icon;
      
      notificationAction = action;
      
      // Update button style based on action
      actionBtn.className = 'notification-btn';
      if (action === 'bundles') {
        actionBtn.classList.add('secondary');
      } else if (action === 'create') {
        actionBtn.classList.add('success');
      } else if (action === 'popular') {
        actionBtn.classList.add('popular');
      }

      // Show notification
      popup.classList.add('show');
      notificationShown = true;

      // Auto-hide after 10 seconds
      setTimeout(() => {
        if (popup.classList.contains('show')) {
          closeNotification();
        }
      }, 10000);
    }

    function closeNotification() {
      console.log('üî¥ Closing notification...');
      const popup = document.getElementById('notificationPopup');
      if (popup) {
        popup.classList.remove('show');
        console.log('‚úÖ Notification closed');
      } else {
        console.error('‚ùå Popup element not found when trying to close');
      }
    }



    function handleNotificationAction() {
      closeNotification();
      
      switch(notificationAction) {
        case 'survey':
          startSurvey();
          break;
        case 'bundles':
          // Scroll to bundles section
          document.querySelector('.bundles-section').scrollIntoView({ 
            behavior: 'smooth' 
          });
          break;
        case 'popular':
          // Scroll to bundles section to show popular bundles
          document.querySelector('.bundles-section').scrollIntoView({ 
            behavior: 'smooth' 
          });
          break;
        case 'create':
          // Redirect to create bundle page (you can change this URL)
          window.location.href = '#create-bundle'; // Update with actual create bundle URL
          break;
        case 'signup':
          // Redirect to signup page
          window.location.href = 'signup.html';
          break;
        case 'refresh':
          // Refresh the page
          window.location.reload();
          break;
        default:
          startSurvey();
      }
    }

    // Show notification again after certain actions
    function resetNotificationStatus() {
      notificationShown = false;
      setTimeout(() => {
        checkAndShowNotification();
      }, 2000);
    }

    // Force refresh survey status (debug function)
    async function forceRefreshSurveyStatus() {
      console.log('üîÑ Force refreshing survey status...');
      
      const token = localStorage.getItem('token');
      if (!token) {
        alert('Please log in first');
        return;
      }
      
      try {
        // Call debug endpoint to check and fix survey status
        const response = await fetch('https://zapbundle.onrender.com/api/survey/check-status', {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer ' + token,
            'Content-Type': 'application/json'
          }
        });
        
        if (response.ok) {
          const result = await response.json();
          console.log('üîç Survey status check result:', result);
          
          if (result.fixed) {
            alert('‚úÖ Survey status fixed! Your survey completion has been updated.');
          } else {
            alert(`‚ÑπÔ∏è Survey Status:\n- Survey exists: ${result.surveyExists}\n- Survey complete: ${result.surveyComplete}\n- User marked complete: ${result.userMarkedComplete}`);
          }
        }
      } catch (error) {
        console.error('Survey status check failed:', error);
      }
      
      // Update survey button
      await updateSurveyButton();
      
      // Reset and check notifications
      notificationShown = false;
      await checkAndShowNotification();
      
      console.log('‚úÖ Survey status refreshed');
    }

    // Scroll to create bundle section
    function scrollToCreateBundle() {
      const bundlesSection = document.querySelector('.bundles-section');
      if (bundlesSection) {
        bundlesSection.scrollIntoView({ 
          behavior: 'smooth' 
        });
        
        // Highlight the "Create Your Own" bundle card after scrolling
        setTimeout(() => {
          const createBundleCard = document.querySelector('.bundle-card.fade-in-right');
          if (createBundleCard) {
            createBundleCard.style.transform = 'scale(1.05)';
            createBundleCard.style.boxShadow = '0 20px 40px rgba(255, 165, 0, 0.4)';
            createBundleCard.style.transition = 'all 0.3s ease';
            
            // Add a pulsing effect
            createBundleCard.style.animation = 'pulse 2s infinite';
            
            // Reset after 4 seconds
            setTimeout(() => {
              createBundleCard.style.transform = '';
              createBundleCard.style.boxShadow = '';
              createBundleCard.style.animation = '';
            }, 4000);
          }
        }, 1000);
      }
    }

    // Show engagement notification for users who haven't taken action
    async function showEngagementNotification() {
      const token = localStorage.getItem('token');
      if (!token) {
        // Show notification for non-logged-in users
        if (!notificationShown) {
          showNotification(
            'Join SaaSBundilo Today!',
            'Get early access to exclusive SaaS bundles and save up to 70%',
            'Get Early Access',
            'signup',
            'fas fa-rocket'
          );
        }
        return;
      }

      // For logged-in users, check if they need encouragement
      try {
        const profileResponse = await fetch('https://zapbundle.onrender.com/api/profile', {
          headers: { 'Authorization': 'Bearer ' + token }
        });
        
        if (profileResponse.ok) {
          const profile = await profileResponse.json();
          
          // If user hasn't completed survey after 30 seconds, show encouragement
          if (!profile.surveyCompleted && !notificationShown) {
            showNotification(
              'Quick Survey - 2 Minutes!',
              'Help us recommend the perfect SaaS bundles for your needs',
              'Start Survey',
              'survey',
              'fas fa-clock'
            );
          }
        }
      } catch (error) {
        console.log('Engagement notification error:', error);
      }
    }


    
    // Ensure this runs after DOM is fully loaded
    window.addEventListener('DOMContentLoaded', function() {
      clearOldSurveyData(); // Clear old localStorage data
      renderNavButtonArea();
      updateSurveyButton();
      
      // Show notification after a delay so users can see the page first
      setTimeout(() => {
        checkAndShowNotification();
      }, 3000); // 3 second delay
      
      // Show additional engagement notification after 30 seconds if user is still on page
      setTimeout(() => {
        showEngagementNotification();
      }, 30000); // 30 second delay
    });
    
    // Check if user already has this bundle
    async function checkIfBundleExists(bundleName) {
      const token = localStorage.getItem('token');
      if (!token) return false;
      
      try {
        const res = await fetch("https://zapbundle.onrender.com/api/profile", {
          headers: {
            "Authorization": "Bearer " + token
          }
        });
        
        if (res.ok) {
          const profile = await res.json();
          if (profile.selectedBundles && Array.isArray(profile.selectedBundles)) {
            return profile.selectedBundles.includes(bundleName);
          }
        }
        return false;
      } catch (err) {
        console.error("Error checking bundle:", err);
        return false;
      }
    }
    
    async function handleBundleClick(bundleName) {
      const token = localStorage.getItem('token');
      if (!token) {
        window.location.href = "signup.html";
        return;
      }
      
      // If "Create Your Own Bundle", show popup
      if (bundleName === 'custom') {
        openMenu(true);
        return;
      }
      
      // Check if user already has this bundle
      const bundleExists = await checkIfBundleExists(bundleName);
      if (bundleExists) {
        alert(`You already have the "${bundleName}" bundle in your account.`);
        return;
      }
      
      // Otherwise, register the bundle to the user's account
      try {
        const res = await fetch("https://zapbundle.onrender.com/api/register-bundle", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + token
          },
          body: JSON.stringify({ bundle: bundleName })
        });
        
        const data = await res.json();
        if (res.ok) {
          alert(`Bundle "${bundleName}" registered to your account!`);
        } else {
          alert(data.error || "Failed to register bundle.");
        }
      } catch (err) {
        alert("Network error. Please try again.");
      }
    }
    
    async function submitCustomBundle() {
      const token = getToken();
      if (!token) {
        window.location.href = "signup.html";
        return;
      }
      
      // Gather selected SaaS tools
      const checked = Array.from(document.querySelectorAll('#saasList input[type="checkbox"]:checked'))
        .map(cb => cb.value);
      
      const otherChecked = document.getElementById('otherBundleCheck').checked;
      let otherValue = "";
      
      if (otherChecked) {
        otherValue = document.getElementById('otherBundleInput').value.trim();
        if (otherValue) checked.push(otherValue);
      }
      
      if (checked.length === 0) {
        alert("Please select at least one SaaS tool.");
        return;
      }
      
      // Remove duplicate SaaS tools
      const uniqueChecked = [...new Set(checked)];
      
      // Create the bundle string
      const bundleString = uniqueChecked.join(", ");
      
      // Check if user already has this bundle
      const bundleExists = await checkIfBundleExists(bundleString);
      if (bundleExists) {
        alert(`You already have a bundle with these SaaS tools in your account.`);
        return;
      }
      
      try {
        const res = await fetch("https://zapbundle.onrender.com/api/register-bundle", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + token
          },
          body: JSON.stringify({ bundle: bundleString })
        });
        
        const data = await res.json();
        if (res.ok) {
          alert("Custom bundle registered to your account!");
          closeMenu();
        } else {
          alert(data.error || "Failed to register custom bundle.");
        }
      } catch (err) {
        alert("Network error. Please try again.");
      }
    }
  </script>

  <!-- Survey Modal -->
  <div id="surveyModal" class="survey-modal">
    <div class="survey-modal-content">
      <div class="survey-progress">
        <div class="survey-progress-bar" id="surveyProgressBar"></div>
      </div>
      
      <div class="survey-question-container" id="surveyQuestionContainer">
        <!-- Questions will be dynamically inserted here -->
      </div>
      
      <div class="survey-navigation">
        <button id="surveySkipBtn" class="survey-skip-btn">Skip</button>
        <button id="surveyNextBtn" class="survey-next-btn">Next</button>
        <button id="surveyPrevBtn" class="survey-prev-btn" style="display: none;">Previous</button>
        <button id="surveySubmitBtn" class="survey-submit-btn" style="display: none;">Submit</button>
      </div>
      
      <button class="survey-close-btn" onclick="closeSurvey()">&times;</button>
    </div>
  </div>

  <!-- Notification Popup -->
  <div id="notificationPopup" class="notification-popup">
    <div class="notification-content">
      <button class="notification-close" onclick="closeNotification()">&times;</button>
      <div class="notification-icon">
        <i class="fas fa-bell"></i>
      </div>
      <div class="notification-text">
        <h4 id="notificationTitle">Complete Your Journey!</h4>
        <p id="notificationMessage">Take our survey to get personalized bundle recommendations</p>
      </div>
      <button id="notificationAction" class="notification-btn" onclick="handleNotificationAction()">
        Take Survey
      </button>
    </div>
  </div>

  <style>
    /* Survey Modal Styles */
    .survey-modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      animation: fadeIn 0.3s ease-out;
    }

    .survey-modal-content {
      position: relative;
      background-color: white;
      margin: 2% auto;
      padding: 40px;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideIn {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .survey-progress {
      width: 100%;
      height: 6px;
      background-color: #e2e8f0;
      border-radius: 3px;
      margin-bottom: 30px;
      overflow: hidden;
    }

    .survey-progress-bar {
      height: 100%;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      border-radius: 3px;
      transition: width 0.3s ease;
      width: 0%;
    }

    .survey-question-container {
      min-height: 200px;
      margin-bottom: 20px;
      padding-bottom: 20px;
      flex: 1;
      overflow-y: auto;
    }

    .survey-question {
      display: none;
      animation: questionSlide 0.3s ease-out;
    }

    .survey-question.active {
      display: block;
    }

    @keyframes questionSlide {
      from { transform: translateX(30px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .survey-question h3 {
      color: var(--dark);
      font-size: 1.5rem;
      margin-bottom: 20px;
      font-weight: 600;
    }

    .survey-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .survey-option {
      display: flex;
      align-items: center;
      padding: 18px 20px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      background-color: #f8fafc;
      user-select: none;
      min-height: 60px;
    }

    .survey-option:hover {
      border-color: var(--primary);
      background-color: #f1f5f9;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);
    }

    .survey-option.selected {
      border-color: var(--primary);
      background-color: #eef2ff;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
      transform: translateY(-1px);
    }

    .survey-option:active {
      transform: translateY(0);
    }

    .survey-option input[type="radio"],
    .survey-option input[type="checkbox"] {
      margin-right: 15px;
      transform: scale(1.3);
      accent-color: var(--primary);
      cursor: pointer;
    }

    .survey-option label {
      cursor: pointer;
      font-weight: 500;
      color: var(--dark);
      flex: 1;
      font-size: 1rem;
      line-height: 1.4;
    }

    .survey-text-input {
      width: 100%;
      padding: 15px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 16px;
      font-family: 'Poppins', sans-serif;
      transition: border-color 0.3s ease;
    }

    .survey-text-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .survey-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e2e8f0;
      position: sticky;
      bottom: 0;
      background-color: white;
      z-index: 10;
    }

    .survey-skip-btn,
    .survey-next-btn,
    .survey-prev-btn,
    .survey-submit-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
    }

    .survey-skip-btn {
      background-color: #f1f5f9;
      color: var(--gray);
    }

    .survey-skip-btn:hover {
      background-color: #e2e8f0;
    }

    .survey-next-btn,
    .survey-submit-btn {
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      color: white;
    }

    .survey-next-btn:hover,
    .survey-submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
    }

    .survey-prev-btn {
      background-color: #6b7280;
      color: white;
    }

    .survey-prev-btn:hover {
      background-color: #4b5563;
    }

    .survey-close-btn {
      position: absolute;
      top: 15px;
      right: 20px;
      background: none;
      border: none;
      font-size: 30px;
      color: var(--gray);
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .survey-close-btn:hover {
      color: var(--danger);
    }

    .survey-thank-you {
      text-align: center;
      padding: 40px 20px;
    }

    .survey-thank-you h3 {
      color: var(--success);
      font-size: 2rem;
      margin-bottom: 15px;
    }

    .survey-thank-you p {
      color: var(--gray);
      font-size: 1.1rem;
    }

    @media (max-width: 768px) {
      .survey-modal-content {
        margin: 5% auto;
        padding: 25px 15px;
        width: 95%;
        max-height: 95vh;
      }

      .survey-question h3 {
        font-size: 1.3rem;
      }

      .survey-option {
        padding: 15px;
        min-height: 50px;
      }

      .survey-navigation {
        flex-wrap: wrap;
        gap: 10px;
        padding: 15px 0;
      }

      .survey-skip-btn,
      .survey-next-btn,
      .survey-prev-btn,
      .survey-submit-btn {
        flex: 1;
        min-width: 120px;
      }

      .survey-skip-btn,
      .survey-next-btn,
      .survey-prev-btn,
      .survey-submit-btn {
        width: 100%;
      }
    }
  </style>

  <script>
    // Survey Questions Configuration
    const surveyQuestions = [
      {
        id: 1,
        question: "What type of business do you run?",
        type: "radio",
        required: true,
        options: [
          "E-commerce/Online Store",
          "SaaS/Software Company",
          "Digital Marketing Agency",
          "Consulting/Professional Services",
          "Content Creation/Media",
          "Freelancer/Solo Entrepreneur",
          "Other"
        ]
      },
      {
        id: 2,
        question: "What's your monthly budget for SaaS tools?",
        type: "radio",
        required: true,
        options: [
          "Under $100",
          "$100 - $500",
          "$500 - $1,000",
          "$1,000 - $2,500",
          "$2,500 - $5,000",
          "Over $5,000"
        ]
      },
      {
        id: 3,
        question: "Which categories of SaaS tools do you use most? (Select all that apply)",
        type: "checkbox",
        required: true,
        options: [
          "Project Management (Asana, Trello, Monday)",
          "Communication (Slack, Discord, Teams)",
          "Design & Creative (Figma, Canva, Adobe)",
          "Marketing & Analytics (HubSpot, Mailchimp, Google Analytics)",
          "Development & Code (GitHub, Vercel, AWS)",
          "Customer Support (Zendesk, Intercom, Freshdesk)",
          "Finance & Accounting (QuickBooks, Stripe, PayPal)",
          "HR & Productivity (Notion, Calendly, Zoom)"
        ]
      },
      {
        id: 4,
        question: "What's your biggest challenge with current SaaS subscriptions?",
        type: "radio",
        required: false,
        skippable: true,
        options: [
          "Too expensive overall",
          "Hard to manage multiple subscriptions",
          "Underutilizing paid features",
          "Difficulty finding the right tools",
          "Integration issues between tools",
          "Billing and payment management"
        ]
      },
      {
        id: 5,
        question: "How did you hear about SaaSBundilo?",
        type: "radio",
        required: false,
        skippable: true,
        options: [
          "Social Media",
          "Search Engine",
          "Friend/Colleague Recommendation",
          "Online Advertisement",
          "Blog/Article",
          "Other"
        ]
      },
      {
        id: 6,
        question: "Any specific SaaS tools you'd like to see in our bundles?",
        type: "text",
        required: false,
        skippable: true,
        placeholder: "Tell us about any specific tools you'd love to see bundled together..."
      }
    ];

    let currentQuestionIndex = 0;
    let surveyAnswers = {};

    async function startSurvey() {
      // Check if user is logged in
      const token = localStorage.getItem('token');
      if (!token) {
        alert('Please log in to take the survey.');
        window.location.href = 'signup.html';
        return;
      }

      try {
        // First check user profile for completion status
        const profileResponse = await fetch('https://zapbundle.onrender.com/api/profile', {
          headers: {
            'Authorization': 'Bearer ' + token
          }
        });
        
        if (profileResponse.ok) {
          const profile = await profileResponse.json();
          console.log('Profile survey status:', profile.surveyCompleted);
          
          if (profile.surveyCompleted) {
            alert('You have already completed the survey. Thank you!');
            return;
          }
        }
        
        // Load existing survey data
        const surveyResponse = await fetch('https://zapbundle.onrender.com/api/survey', {
          headers: {
            'Authorization': 'Bearer ' + token
          }
        });
        
        if (surveyResponse.ok) {
          const surveyData = await surveyResponse.json();
          console.log('Survey data:', surveyData);
          
          // Load existing answers if any
          surveyAnswers = surveyData.answers || {};
          console.log('Loaded existing survey answers:', surveyAnswers);
        }
      } catch (error) {
        console.error('Error loading survey data:', error);
        // Continue with empty survey if API call fails
        surveyAnswers = {};
      }

      currentQuestionIndex = 0;
      document.getElementById('surveyModal').style.display = 'block';
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
      showQuestion(currentQuestionIndex);
    }

    function closeSurvey() {
      document.getElementById('surveyModal').style.display = 'none';
      document.body.style.overflow = 'auto'; // Restore scrolling
    }

    function showQuestion(index) {
      const question = surveyQuestions[index];
      const container = document.getElementById('surveyQuestionContainer');
      const progressBar = document.getElementById('surveyProgressBar');
      
      // Update progress bar
      const progress = ((index + 1) / surveyQuestions.length) * 100;
      progressBar.style.width = progress + '%';
      
      // Generate question HTML
      let questionHTML = `
        <div class="survey-question active">
          <h3>${question.question}</h3>
      `;
      
      if (question.type === 'radio') {
        questionHTML += '<div class="survey-options">';
        question.options.forEach((option, optionIndex) => {
          const isSelected = surveyAnswers[question.id] === option;
          questionHTML += `
            <div class="survey-option ${isSelected ? 'selected' : ''}" onclick="selectOption(${question.id}, '${option}', 'radio', this)">
              <input type="radio" name="question_${question.id}" value="${option}" ${isSelected ? 'checked' : ''}>
              <label>${option}</label>
            </div>
          `;
        });
        questionHTML += '</div>';
      } else if (question.type === 'checkbox') {
        questionHTML += '<div class="survey-options">';
        question.options.forEach((option, optionIndex) => {
          const isSelected = surveyAnswers[question.id] && surveyAnswers[question.id].includes(option);
          questionHTML += `
            <div class="survey-option ${isSelected ? 'selected' : ''}" onclick="selectOption(${question.id}, '${option}', 'checkbox', this)">
              <input type="checkbox" name="question_${question.id}" value="${option}" ${isSelected ? 'checked' : ''}>
              <label>${option}</label>
            </div>
          `;
        });
        questionHTML += '</div>';
      } else if (question.type === 'text') {
        const currentValue = surveyAnswers[question.id] || '';
        questionHTML += `
          <textarea class="survey-text-input" placeholder="${question.placeholder}" 
                    onchange="selectOption(${question.id}, this.value, 'text', this)">${currentValue}</textarea>
        `;
      }
      
      questionHTML += '</div>';
      container.innerHTML = questionHTML;
      
      // Update navigation buttons
      updateNavigationButtons(index, question);
    }

    function selectOption(questionId, value, type, element) {
      if (type === 'radio') {
        surveyAnswers[questionId] = value;
        // Update visual selection for radio buttons
        const allOptions = element.parentNode.querySelectorAll('.survey-option');
        allOptions.forEach(opt => {
          opt.classList.remove('selected');
          const radio = opt.querySelector('input[type="radio"]');
          if (radio) radio.checked = false;
        });
        element.classList.add('selected');
        const radio = element.querySelector('input[type="radio"]');
        if (radio) radio.checked = true;
      } else if (type === 'checkbox') {
        if (!surveyAnswers[questionId]) {
          surveyAnswers[questionId] = [];
        }
        
        const checkbox = element.querySelector('input[type="checkbox"]');
        // Toggle checkbox state when option is clicked
        checkbox.checked = !checkbox.checked;
        
        if (checkbox.checked) {
          if (!surveyAnswers[questionId].includes(value)) {
            surveyAnswers[questionId].push(value);
          }
          element.classList.add('selected');
        } else {
          surveyAnswers[questionId] = surveyAnswers[questionId].filter(item => item !== value);
          element.classList.remove('selected');
        }
      } else if (type === 'text') {
        surveyAnswers[questionId] = value;
      }
      
      // Auto-save progress after each answer
      autoSaveProgress();
    }

    // Auto-save survey progress
    async function autoSaveProgress() {
      const token = localStorage.getItem('token');
      if (!token) return;
      
      try {
        const response = await fetch('https://zapbundle.onrender.com/api/survey', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ' + token
          },
          body: JSON.stringify({
            answers: surveyAnswers,
            isComplete: false
          })
        });
        
        if (response.ok) {
          console.log('Progress auto-saved successfully');
        } else {
          console.error('Auto-save failed with status:', response.status);
        }
      } catch (error) {
        console.error('Auto-save failed:', error);
      }
    }

    function updateNavigationButtons(index, question) {
      const skipBtn = document.getElementById('surveySkipBtn');
      const nextBtn = document.getElementById('surveyNextBtn');
      const prevBtn = document.getElementById('surveyPrevBtn');
      const submitBtn = document.getElementById('surveySubmitBtn');
      
      // Show/hide skip button
      skipBtn.style.display = question.skippable ? 'block' : 'none';
      
      // Show/hide previous button
      prevBtn.style.display = index > 0 ? 'block' : 'none';
      
      // Show next or submit button
      if (index === surveyQuestions.length - 1) {
        nextBtn.style.display = 'none';
        submitBtn.style.display = 'block';
      } else {
        nextBtn.style.display = 'block';
        submitBtn.style.display = 'none';
      }
    }

    function nextQuestion() {
      const currentQuestion = surveyQuestions[currentQuestionIndex];
      
      // Check if required question is answered
      if (currentQuestion.required && !surveyAnswers[currentQuestion.id]) {
        alert('Please answer this question before proceeding.');
        return;
      }
      
      if (currentQuestionIndex < surveyQuestions.length - 1) {
        currentQuestionIndex++;
        showQuestion(currentQuestionIndex);
      }
    }

    function previousQuestion() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        showQuestion(currentQuestionIndex);
      }
    }

    function skipQuestion() {
      const currentQuestion = surveyQuestions[currentQuestionIndex];
      if (currentQuestion.skippable) {
        nextQuestion();
      }
    }

    async function submitSurvey() {
      try {
        const token = localStorage.getItem('token');
        
        // Check if all required questions are answered
        const requiredQuestions = surveyQuestions.filter(q => q.required);
        const unansweredRequired = requiredQuestions.filter(q => 
          !surveyAnswers[q.id] || 
          (Array.isArray(surveyAnswers[q.id]) && surveyAnswers[q.id].length === 0)
        );
        
        const isComplete = unansweredRequired.length === 0;
        console.log('üìã Survey submission - isComplete:', isComplete);
        console.log('üìã Unanswered required questions:', unansweredRequired.length);
        
        const response = await fetch('https://zapbundle.onrender.com/api/survey', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ' + token
          },
          body: JSON.stringify({
            answers: surveyAnswers,
            completedAt: new Date().toISOString(),
            isComplete: isComplete
          })
        });

        if (response.ok) {
          const result = await response.json();
          
          if (isComplete) {
            // Show completion thank you message
            showThankYou(true);
          } else {
            // Show partial submission message
            showThankYou(false, unansweredRequired);
          }
          
          // Update survey button to reflect database status
          updateSurveyButton();
          
          // Reset notification status to show next step
          if (isComplete) {
            resetNotificationStatus();
          }
        } else {
          throw new Error('Failed to submit survey');
        }
      } catch (error) {
        console.error('Survey submission error:', error);
        alert('There was an error submitting your survey. Please try again.');
      }
    }

    function showThankYou(isComplete = true, unansweredQuestions = []) {
      const container = document.getElementById('surveyQuestionContainer');
      
      if (isComplete) {
        container.innerHTML = `
          <div class="survey-thank-you">
            <h3>üéâ Survey Completed!</h3>
            <p>Thank you for completing our survey! Your responses help us create better SaaS bundles for businesses like yours.</p>
            <p>We'll notify you when new bundles matching your needs are available!</p>
          </div>
        `;
        
        // Auto-close after 3 seconds for completed surveys
        setTimeout(() => {
          closeSurvey();
        }, 3000);
      } else {
        const unansweredList = unansweredQuestions.map(q => `‚Ä¢ ${q.question}`).join('<br>');
        container.innerHTML = `
          <div class="survey-thank-you">
            <h3>üìù Progress Saved!</h3>
            <p>Your responses have been saved. You can continue the survey anytime by clicking "Take the Survey" again.</p>
            <div style="margin: 20px 0; padding: 15px; background-color: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
              <strong>Still need to answer:</strong><br>
              ${unansweredList}
            </div>
            <p><small>Complete all required questions to finish your survey!</small></p>
          </div>
        `;
        
        // Auto-close after 5 seconds for partial submissions
        setTimeout(() => {
          closeSurvey();
        }, 5000);
      }
      
      // Hide navigation buttons
      document.querySelector('.survey-navigation').style.display = 'none';
    }

    // Event listeners for navigation buttons
    document.getElementById('surveyNextBtn').addEventListener('click', nextQuestion);
    document.getElementById('surveyPrevBtn').addEventListener('click', previousQuestion);
    document.getElementById('surveySkipBtn').addEventListener('click', skipQuestion);
    document.getElementById('surveySubmitBtn').addEventListener('click', submitSurvey);

    // Close modal when clicking outside
    document.getElementById('surveyModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeSurvey();
      }
    });

    // Remove duplicate function - using the async version above
  </script>
</body>
</html>